#!/bin/sh
set -x

rustup target add x86_64-unknown-linux-gnu
# Musl needs: `sudo apt install musl-tools` 
rustup target add x86_64-unknown-linux-musl
# Windows needs: `sudo apt install binutils-mingw-w64 mingw-w64`
rustup target add x86_64-pc-windows-gnu

cargo build \
 	--target x86_64-unknown-linux-gnu \
 	--target x86_64-unknown-linux-musl \
  --target x86_64-pc-windows-gnu \
 	--release

# Binary for Raspberry Pi (32 bit)
# needs: `sudo apt install crossbuild-essential-armhf`
rustup target add armv7-unknown-linux-gnueabihf
CARGO_TARGET_ARMV7_UNKNOWN_LINUX_GNUEABIHF_LINKER=/usr/bin/arm-linux-gnueabihf-gcc \
   cargo build  --target armv7-unknown-linux-gnueabihf  --release

# Binary for Raspberry Pi (arm64, 64 bit)
# needs: `sudo apt install crossbuild-essential-arm64`
rustup target add aarch64-unknown-linux-gnu
CARGO_TARGET_AARCH64_UNKNOWN_LINUX_GNU_LINKER=/usr/bin/aarch64-linux-gnu-gcc \
   cargo build  --target aarch64-unknown-linux-gnu  --release
   
